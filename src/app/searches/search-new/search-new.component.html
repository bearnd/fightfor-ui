<div class="main-content">
  <div class="container-fluid">
    <div class="row" *ngIf="!isLoading()">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header card-header-icon card-header-rose">
            <div class="card-icon">
              <i class="material-icons">add_circle</i>
            </div>
            <div class="row">
              <div class="col-md-8">
                <h4 class="card-title">
                  Search
                </h4>
              </div>

              <div class="col-md-4">
                <button
                  mat-raised-button mat-min-fab
                  class="btn btn-rose btn-link btn-round btn-fab pull-right"
                  (click)="toggleSaved()"
                  [disableRipple]="true"
                  matTooltip="Save this search"
                  [matTooltipPosition]="'before'"
                >
                  <i class="material-icons">{{ isSaved ? "favorite" : "favorite_border" }}</i>
                </button>
              </div>
            </div>
          </div>
          <div class="card-body">
            <form [formGroup]="form" (ngSubmit)="onSubmit()">

              <div class="form-group">
                <!--Conditions chip-input with autocomplete.-->
                <mat-form-field
                  class="term-list-input"
                  [hintLabel]="descriptorsSelected.length ? null: 'Enter terms you would like to search for and select the corresponding descriptors'"
                >
                  <mat-chip-list #descriptorsChipList>
                    <mat-chip
                      *ngFor="let descriptor of descriptorsSelected"
                      [selectable]="false"
                      [selected]="true"
                      [removable]="true"
                      (remove)="onRemoveDescriptor(descriptor)"
                    >
                      {{ descriptor.name }}
                      <mat-icon matChipRemove>cancel</mat-icon>
                    </mat-chip>
                    <input
                      #inputDescriptors
                      type="text"
                      id="descriptors"
                      formControlName="descriptors"
                      placeholder="MeSH Descriptors"
                      [matAutocomplete]="descriptorsAutocomplete"
                      [matChipInputFor]="descriptorsChipList"
                      [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                    />
                  </mat-chip-list>
                  <!--Autocomplete for conditions chip-input.-->
                  <mat-autocomplete
                    [autoActiveFirstOption]="true"
                    #descriptorsAutocomplete="matAutocomplete"
                    (optionSelected)="onDescriptorSelected($event)"
                  >
                    <mat-option *ngFor="let descriptor of descriptorsAll" [value]="descriptor">
                      {{ descriptor.name }}
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>
              </div>

              <div class="form-group">
                <label for="sliderYearRange">Year-Range</label>
                <ion-range-slider
                  id="sliderYearRange"
                  #sliderYearRange
                  type="double"
                  [min]="studyStartDateRangeAll.dateBeg.getFullYear()"
                  [max]="studyStartDateRangeAll.dateEnd.getFullYear()"
                  [from]="studyStartYearRangeSelected.yearBeg"
                  [to]="studyStartYearRangeSelected.yearEnd"
                  style="width: 300px;"
                  [prettify_enabled]="false"
                  (onFinish)="onSliderYearRangeFinish($event)"
                >
                </ion-range-slider>
              </div>

              <div class="form-group">
                <button
                  mat-raised-button
                  type="submit"
                  class="btn btn-rose mat-raised-button pull-right"
                  [disabled]="!descriptorsSelected.length"
                >
                  <span class="mat-button-wrapper">Search</span>
                </button>
              </div>
            </form>
          </div>
          <div class="card-footer">
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
